import math
import random

from torchvision.datasets import StanfordCars

VAL_ITEMS_IDX = [539, 6619, 54, 3078, 3446, 1171, 540, 545, 917, 1, 5051, 4916, 5533, 2420, 3050, 6247, 4443, 5241,
                 1031, 2174, 5161, 1872, 481, 6974, 2, 3784, 4615, 4324, 6076, 3519, 2954, 7465, 94, 3, 6086, 2806,
                 3099, 6538, 999, 3952, 3938, 2784, 905, 2512, 2598, 3432, 5223, 6694, 2841, 1865, 2774, 5982, 983,
                 6743, 5087, 1610, 5587, 5771, 7849, 5998, 1921, 4782, 480, 1390, 5695, 455, 1362, 2259, 4507, 2872,
                 5305, 3615, 6087, 2547, 4455, 3987, 6193, 1920, 2149, 8, 1837, 7784, 7927, 1603, 6883, 6625, 7410,
                 2211, 2465, 7195, 1145, 4091, 2470, 7482, 1919, 4456, 7416, 4486, 6409, 291, 188, 3527, 6156, 1692,
                 266, 7351, 7391, 4307, 5882, 1946, 3286, 6607, 2251, 7921, 7331, 6091, 4156, 7295, 7147, 3381, 573,
                 7691, 5057, 2636, 6848, 2705, 7480, 6879, 1392, 6306, 5676, 3881, 4214, 1990, 1618, 5925, 7610, 1242,
                 6872, 5062, 5232, 3484, 3863, 2413, 14, 7364, 1078, 5703, 3121, 3497, 5957, 1843, 616, 5525, 7361,
                 7251, 2709, 145, 2336, 1057, 1348, 5625, 6341, 7344, 1184, 548, 1821, 731, 189, 3504, 5952, 6942,
                 7801, 1758, 228, 511, 3421, 5032, 4224, 3646, 5030, 7093, 3096, 3599, 3329, 3520, 1049, 759, 7802,
                 463, 2270, 2845, 2982, 6285, 336, 2881, 1257, 7368, 4406, 5357, 4399, 533, 3211, 1099, 6458, 4623,
                 1236, 600, 3443, 7593, 501, 2952, 1970, 7523, 1255, 7155, 5914, 6568, 2036, 1501, 23, 6660, 3652,
                 4522, 7846, 3642, 1048, 514, 4653, 942, 4997, 3340, 2965, 44, 3489, 1340, 3551, 1249, 5089, 5270, 935,
                 4389, 5435, 3628, 1073, 1571, 1659, 1974, 2440, 2370, 2787, 6530, 7074, 4144, 27, 434, 5863, 2704,
                 4815, 5375, 6105, 5719, 4933, 6565, 5216, 6347, 7192, 5685, 6053, 7738, 2885, 1638, 3019, 3817, 1942,
                 791, 4218, 1267, 1021, 3280, 3272, 5039, 7935, 4929, 6476, 4317, 7104, 423, 5113, 7756, 2557, 3685,
                 3187, 5257, 5138, 7001, 2221, 758, 1498, 561, 1570, 5645, 5632, 4904, 1488, 6228, 6058, 1877, 3808,
                 1013, 7438, 720, 5765, 6520, 1806, 507, 2643, 6149, 2261, 5013, 2574, 2687, 496, 1951, 1814, 7065,
                 1273, 1275, 3058, 2425, 288, 588, 7621, 7035, 6323, 3175, 119, 1424, 4639, 4363, 2556, 7356, 3530,
                 6457, 4201, 7395, 2481, 6770, 3048, 3843, 305, 4141, 590, 6843, 1542, 6757, 108, 5290, 5171, 5102,
                 2776, 819, 1323, 5893, 2460, 7123, 7067, 7025, 6179, 6254, 7576, 164, 2587, 410, 4428, 40, 3493, 6209,
                 6298, 5764, 7755, 7139, 3043, 309, 2156, 2989, 1885, 631, 1948, 4832, 3622, 5566, 6150, 594, 4784,
                 1161, 4756, 4426, 396, 827, 5796, 4386, 1914, 6399, 3441, 1247, 475, 6741, 5050, 4578, 7000, 1800,
                 3528, 2372, 1356, 6331, 4258, 7976, 4798, 6531, 2799, 1726, 3802, 46, 4410, 4055, 2941, 1714, 3540,
                 5922, 6639, 6894, 4238, 6492, 2404, 4736, 7176, 714, 6377, 5253, 1991, 4527, 7537, 4732, 3091, 1329,
                 2933, 5410, 7149, 264, 4314, 6522, 7220, 7557, 8003, 4004, 407, 6372, 6959, 7836, 3558, 4923, 5167,
                 50, 6085, 7010, 1513, 1321, 3110, 1375, 655, 2589, 5652, 1506, 183, 6804, 1880, 5622, 3537, 3494,
                 5500, 4737, 7013, 6788, 7505, 1333, 5452, 2237, 878, 5309, 7077, 3363, 55, 4221, 7710, 6439, 6775,
                 2083, 5732, 1993, 1631, 57, 1134, 4719, 784, 1609, 4475, 5557, 107, 5183, 1006, 3067, 3836, 6502,
                 2697, 58, 1159, 6262, 244, 5791, 6881, 2644, 4606, 3300, 2483, 5901, 3538, 7371, 6821, 813, 5131,
                 5613, 3822, 870, 1385, 4983, 3154, 6319, 363, 6516, 6163, 7866, 3989, 1876, 4788, 7152, 6760, 6014,
                 5724, 2284, 3412, 5392, 6270, 1887, 4733, 2063, 373, 3845, 5694, 4237, 4793, 5304, 7542, 2541, 3253,
                 3812, 1209, 2111, 2194, 634, 7126, 2152, 339, 1722, 4499, 6147, 4496, 5095, 5707, 7733, 825, 3734,
                 1502, 867, 191, 4803, 660, 3133, 597, 1897, 1300, 3729, 5886, 2624, 1304, 7789, 4087, 5022, 2216,
                 1460, 4116, 2664, 7392, 5887, 1116, 2834, 1517, 6308, 2596, 5710, 5818, 1070, 7928, 5164, 605, 3032,
                 3847, 1127, 3742, 6043, 5358, 3401, 7116, 2084, 6393, 3341, 2405, 3798, 6203, 1616, 1892, 5009, 2186,
                 4925, 1011, 572, 1334, 5934, 6643, 5819, 1187, 789, 4319, 4777, 1678, 300, 3673, 3696, 2384, 6095,
                 83, 2856, 6224, 6754, 5754, 1142, 6013, 3200, 6402, 2041, 4212, 5760, 5559, 4148, 7714, 7396, 179,
                 6071, 2437, 7822, 7713, 4618, 1561, 2798, 4422, 3039, 5740, 3092, 5751, 4241, 5193, 3129, 2145, 3573,
                 7690, 6909, 5035, 1935, 6275, 8015, 7913, 2241, 6795, 3864, 1672, 7229, 6549, 2537, 2987, 6746, 6623,
                 7326, 4104, 7637, 3942, 4645, 435, 1343, 7059, 4190, 1452, 7136, 1195, 1308, 696, 2682, 5424, 614,
                 2108, 3712, 3954, 3159, 2558, 2550, 7046, 4219, 5858, 1042, 7961, 159, 3170, 3853, 7918, 5128, 5938,
                 6939, 6288, 2168, 7495, 7122, 1687, 6649, 6136, 97, 3366, 1709, 5244, 5627, 5659, 2566, 1465, 6626,
                 1003, 5234, 6767, 2223, 5008, 7064, 5513, 4718, 3933, 1597, 587, 1754, 7427, 99, 3773, 4843, 6523,
                 100, 1271, 6337, 4430, 7700, 4885, 287, 659, 4477, 6567, 2618, 6292, 4132, 3034, 5493, 3689, 1964,
                 5981, 2929, 5025, 1148, 3038, 4320, 6778, 102, 5551, 4655, 2736, 7924, 4751, 1158, 1825, 2971, 1012,
                 512, 3108, 1512, 2164, 7773, 5905, 3702, 5647, 4041, 5397, 3746, 7194, 902, 5294, 4023, 2528, 198,
                 7205, 1279, 2360, 6683, 5845, 4948, 1189, 5409, 2822, 4668, 7300, 7170, 5602, 4706, 6725, 7061, 374,
                 411, 3483, 771, 6613, 2911, 4098, 4120, 7661, 7393, 6840, 4525, 6089, 7852, 898, 2832, 6877, 5896,
                 4517, 584, 773, 4364, 2391, 7841, 3618, 2836, 116, 7885, 4608, 3501, 2680, 2932, 1817, 661, 7559, 420,
                 5960, 881, 7581, 4800, 4849, 6485, 7743, 4316, 5149, 2814, 213, 4196, 671, 4538, 7436, 6462, 1798,
                 980, 2025, 6545, 122, 2500, 1203, 1059, 2505, 2245, 2960, 275, 4707, 515, 7858, 5310, 433, 6080, 125,
                 6528, 391, 3258, 3365, 1953, 126, 4016, 2071, 4077, 4256, 7373, 2432, 5382, 127, 5580, 2741, 5229,
                 1325, 4950, 710, 3747, 2594, 2632, 7535, 1445, 2821, 2022, 5673, 3631, 6671, 5329, 6126, 7544, 885,
                 6647, 3438, 6981, 6259, 543, 7991, 5873, 3435, 6863, 3424, 1386, 532, 4073, 4459, 1122, 5537, 7742,
                 6991, 7693, 7130, 135, 889, 7980, 280, 5993, 4498, 5712, 1808, 6866, 7340, 1915, 1220, 3074, 2065,
                 7003, 2502, 5484, 5446, 3600, 5040, 4617, 5501, 3189, 2843, 5592, 4976, 3130, 987, 3336, 3547, 3809,
                 1859, 4376, 740, 6672, 201, 3828, 1172, 727, 5807, 2782, 7786, 577, 2368, 5667, 1545, 153, 141, 4555,
                 495, 1522, 355, 5770, 3112, 6936, 6240, 2282, 2796, 4783, 2606, 1097, 5110, 7275, 1222, 4947, 5691,
                 3495, 3579, 3909, 5596, 6226, 6664, 5899, 3301, 2131, 962, 2645, 3684, 5923, 6025, 7033, 4862, 5495,
                 144, 2950, 484, 2020, 6387, 7719, 2484, 197, 3103, 2230, 5689, 204, 4577, 996, 6698, 1463, 2023, 7237,
                 1235, 6008, 3898, 2972, 687, 3826, 7736, 3992, 5385, 3053, 1433, 551, 2721, 5061, 1705, 151, 3755,
                 2639, 3460, 1973, 438, 3491, 3425, 7511, 3407, 796, 7607, 404, 7457, 6258, 4246, 2739, 4534, 1256,
                 1689, 6197, 4720, 690, 1178, 7158, 155, 5403, 6847, 3198, 4330, 1867, 5966, 4177, 7365, 6710, 6815,
                 4127, 4774, 3299, 5682, 310, 4206, 1446, 340, 4473, 386, 6641, 5912, 2795, 1051, 1651, 1852, 4609,
                 1691, 7932, 6289, 7540, 3967, 7404, 2580, 2281, 3463, 831, 4877, 7931, 1287, 1649, 5042, 1400, 416,
                 5677, 5728, 712, 5258, 4002, 7638, 1364, 5600, 591, 7990, 7792, 4295, 7501, 7420, 2185, 3251, 546,
                 6658, 6570, 3076, 3450, 3169, 2510, 2780, 4902, 4242, 4329, 755, 172, 2208, 270, 4691, 3839, 1998,
                 4551, 6997, 409, 7794, 1823, 2701, 3423, 6370, 3062, 2315, 4758, 2141, 4233, 5670, 1748, 4052, 4790,
                 6455, 4380, 6468, 1634, 4310, 7840, 6118, 4919, 458, 2165, 187, 2993, 6923, 6052, 1274, 7282, 1341,
                 4938, 3505, 2410, 6871, 4853, 7904, 2534, 190, 6964, 459, 3232, 4461, 5317, 7859, 4548, 3870, 3577,
                 372, 6501, 5808, 1117, 2573, 6994, 4335, 2592, 1124, 7017, 5092, 4071, 5946, 737, 4593, 2902, 312,
                 1219, 5885, 3877, 3352, 7781, 6606, 4809, 7245, 2585, 8009, 3449, 5006, 6020, 770, 3080, 1681, 5330,
                 3283, 207, 5433, 4692, 2439, 3273, 4142, 1113, 6600, 7761, 3666, 1894, 209, 6697, 1069, 5414, 1315,
                 4420, 1703, 3621, 5729, 2522, 1305, 6320, 5568, 7533, 2744, 1845, 1937, 6435, 345, 2123, 4407, 2115,
                 7454, 7915, 1393, 4379, 6682, 1114, 3716, 5434, 7772, 5637, 7985, 5302, 2509, 3757, 6470, 6663, 5935,
                 6061, 6642, 304, 4010, 1490, 3676, 4037, 3724, 4415, 5866, 1068, 2621, 5081, 267, 1486, 5285, 7372,
                 2969, 1594, 2027, 5038, 3202, 4622, 4468, 5296, 5496, 2507, 5281, 615, 2143, 6653, 3585, 6451, 7347,
                 3736, 490, 3373, 1067, 1640, 1253, 4003, 2433, 5634, 5046, 4179, 483, 2350, 7471, 7015, 1563, 2916,
                 5470, 7506, 2173, 7538, 7746, 5478, 1632, 6814, 238, 2244, 352, 5297, 2501, 4423, 6037, 3238, 3698,
                 3390, 1789, 4275, 2747, 1468, 4343, 3445, 1020, 5398, 402, 6924, 1473, 7563, 7232, 1243, 7639, 7771,
                 1873, 4442, 6832, 1150, 5150, 1047, 4017, 2745, 5599, 6968, 5356, 4942, 729, 3770, 6861, 4123, 7218,
                 3892, 4678, 6573, 5386, 986, 5045, 4114, 4338, 5872, 4288, 2608, 2699, 6229, 1379, 5514, 1889, 6196,
                 1493, 7958, 3180, 6271, 5672, 845, 5615, 7219, 3614, 775, 4408, 3760, 2147, 7117, 7224, 273, 5420,
                 7635, 2754, 341, 1276, 1759, 818, 1556, 2649, 7770, 2406, 7048, 6854, 6381, 7778, 4444, 4210, 1474,
                 1835, 4182, 3871, 2555, 537, 3359, 1002, 6167, 3480, 7083, 2613, 2717, 2804, 700, 5413, 290, 4837,
                 3126, 5196, 2726, 6952, 2473, 5125, 2930, 6826, 4485, 3668, 7423, 6950, 4421, 7735, 1531, 861, 7624,
                 4400, 2641, 4651, 5964, 658, 2137, 5468, 3627, 5822, 4097, 1336, 4313, 4020, 1693, 4576, 5181, 5833,
                 8028, 3743, 754, 6975, 2280, 5355, 3075, 5351, 7584, 3869, 4814, 3212, 4889, 2312, 1462, 6602, 7596,
                 3141, 3161, 6678, 5101, 2848, 608, 1108, 6595, 4906, 1780, 976, 3904, 5669, 318, 6366, 2826, 4391, 808,
                 2536, 3440, 7127, 2055, 6069, 3709, 2936, 1628, 6661, 2904, 4864, 329, 5404, 6633, 5631, 3810, 5617,
                 4178, 1093, 7655, 5781, 7341, 6696, 3197, 4228, 6210, 2207, 3682, 5630, 7389, 6592, 1481, 7531, 4216,
                 1836, 2622, 3231, 7196, 1607, 6941, 2136, 1028, 2378, 5790, 2772, 7823, 7151, 5137, 7242, 1120, 1346,
                 6648, 6564, 4629, 7485, 5368, 2056, 2568, 4558, 5692, 6446, 6173, 2533, 377, 5550, 2445, 1024, 5991,
                 7525, 953, 7757, 3070, 1572, 6354, 7727, 4113, 7865, 1557, 1126, 3234, 4384, 5460, 6535, 6829, 3951,
                 4836, 7023, 835, 6504, 3756, 7112, 6045, 3345, 7307, 498, 6717, 5787, 7956, 1277, 1497, 915, 7702,
                 2162, 2279, 6006, 1608, 3838, 6876, 1327, 1543, 4349, 2039, 547, 7459, 1417, 3250, 5497, 7908, 6316,
                 387, 6222, 1373, 7458, 7987, 6777, 5268, 3754, 7571, 5731, 6930, 5347, 706, 2678, 5423, 1283, 4355,
                 684, 1221, 1739, 6934, 5915, 3024, 3549, 5907, 524, 896, 3924, 5779, 1956, 7950, 7169, 2000, 5360,
                 3662, 426, 6154, 1941, 6102, 6235, 1510, 5472, 3411, 6132, 6836, 1344, 1369, 4107, 5897, 4603, 2085,
                 7765, 7520, 5984, 3083, 1480, 6024, 4059, 3783, 2430, 7094, 4746, 5220, 7758, 7589, 6202, 4168, 6442,
                 1053, 7313, 2235, 7782, 2062, 4987, 6453, 7555, 2490, 5651, 1989, 461, 2850, 5487, 2768, 6084, 7102,
                 1451, 6225, 4140, 467, 5319, 1096, 4673, 4262, 6181, 4199, 6932, 5826, 2548, 4103, 473, 624, 1355,
                 2443, 2409, 1853, 1734, 2827, 7446, 1023, 4030, 1560, 7052, 7929, 5209, 6742, 2679, 3279, 3209, 6176,
                 3431, 3804, 2341, 7552, 1354, 6486, 3018, 2785, 6083, 4970, 3511, 5370, 2400, 7819, 4624, 5509, 5696,
                 1774, 3085, 7828, 4921, 7707, 764, 2529, 3861, 833, 6160, 2759, 2892, 5768, 1781, 3303, 972, 1103,
                 3907, 3482, 1237, 5722, 932, 5788, 1292, 2984, 5965, 5235, 6640, 2728, 5100, 3115, 1578, 7813, 7440,
                 7267, 6448, 1729, 645, 4069, 5238, 3852, 6241, 2374, 4700, 4661, 5877, 4813, 6155, 6064, 6855, 2842,
                 6452, 7619, 1476, 3827, 652, 3768, 7099, 4704, 5479, 6035, 3849, 5321, 4690, 2239, 7829, 6461, 7252,
                 3028, 5526, 6199, 4287, 6048, 5394, 739, 6712, 7510, 1509, 1778, 5776, 2066, 1337, 7478, 3227, 7911,
                 6886, 7704, 4453, 7185, 6726, 3174, 1757, 5466, 6822, 3664, 6369, 3011, 6769, 7914, 4656, 1819, 6334,
                 2004, 7645, 3944, 2496, 5837, 2224, 4125, 4739, 7343, 1358, 4839, 7764, 908, 1010, 1713, 1700, 5593,
                 6070, 5276, 3420, 944, 6483, 2753, 3956, 4448, 1971]

SPLIT = 0.25

if __name__ == '__main__':
    dataset = StanfordCars(
        root='../data',
        split='test'
    )

    labels_to_imgs = dict()

    for idx, (_, img_label) in enumerate(dataset._samples):
        labels_to_imgs[img_label] = [*labels_to_imgs.get(img_label, []), idx]

    val_indices = []
    for label, imgs in labels_to_imgs.items():
        val_imgs = max(1, math.floor(len(imgs) * SPLIT))
        for _ in range(val_imgs):
            selected_item = random.choice(imgs)
            imgs.remove(selected_item)
            val_indices.append(selected_item)

    print(f"VAL ITEMS IDX: {val_indices}")
